{
  "openapi": "3.0.1",
  "info": {
    "title": "CFDI API",
    "description": "API para realizar operaciones con CFDI",
    "version": "0.0.6"
  },
  "servers": [
    {
      "url": "thyphoon.pythonanywhere.com"
    }
  ],
  "paths": {
    "/cfdi/upload": {
      "post": {
        "description": "Permite subir los datos del RFC, clave privada, certificado, contraseña y CIEC del contribuyente.",
        "requestBody": {
          "description": "Datos del contribuyente para subir",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UploadModel"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subida exitosa"
          },
          "400": {
            "description": "Error en la validación de los datos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/cfdi/request": {
      "post": {
        "description": "Solicita CFDI en un rango de fechas.",
        "requestBody": {
          "description": "Datos para solicitar CFDI",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RequestModel"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Solicitud exitosa"
          },
          "400": {
            "description": "Error en la validación de los datos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/cfdi/invoice/{uuid}": {
      "get": {
        "description": "Devuelve los detalles de la factura solicitada utilizando su UUID.",
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "description": "UUID de la factura solicitada",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Retorna los detalles de la factura"
          },
          "404": {
            "description": "Factura no encontrada",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/cfdi/verify": {
      "post": {
        "description": "Verifica si un CFDI es válido.",
        "requestBody": {
          "description": "Datos para verificar el CFDI",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyModel"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "CFDI válido"
          },
          "400": {
            "description": "Error en la validación de los datos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/cfdi/descargar": {
      "post": {
        "description": "Permite descargar un CFDI.",
        "requestBody": {
          "description": "Datos para descargar el CFDI",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DescargarModel"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "CFDI descargado exitosamente"
          },
          "404": {
            "description": "CFDI no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/cfdi/ciec": {
      "post": {
        "description": "Envía una solicitud para obtener la CIEC del contribuyente.",
        "requestBody": {
          "description": "Datos para solicitar la CIEC",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CIECModel"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Solicitud exitosa"
          },
          "400": {
            "description": "Error en la validación de los datos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "UploadModel": {
        "type": "object",
        "required": ["rfc"],
        "properties": {
          "rfc": {
            "type": "string",
            "description": "RFC del contribuyente"
          },
          "private_key": {
            "type": "string",
            "description": "Clave privada en formato PEM"
          },
          "cert": {
            "type": "string",
            "description": "Certificado en formato PEM"
          },
          "password": {
            "type": "string",
            "description": "Contraseña del certificado"
          },
          "ciec": {
            "type": "string",
            "description": "CIEC del contribuyente"
          }
        }
      },
      "RequestModel": {
        "type": "object",
        "required": ["rfc", "startdate", "enddate"],
        "properties": {
          "rfc": {
            "type": "string",
            "description": "RFC del contribuyente"
          },
          "startdate": {
            "type": "string",
            "description": "Fecha de inicio (YYYY-MM-DD)"
          },
          "enddate": {
            "type": "string",
            "description": "Fecha de fin (YYYY-MM-DD)"
          }
        }
      },
      "VerifyModel": {
        "type": "object",
        "required": ["rfc", "uuid"],
        "properties": {
          "rfc": {
            "type": "string",
            "description": "RFC del contribuyente"
          },
          "uuid": {
            "type": "string",
            "description": "UUID del CFDI a verificar"
          }
        }
      },
      "DescargarModel": {
        "type": "object",
        "required": ["rfc", "uuid"],
        "properties": {
          "rfc": {
            "type": "string",
            "description": "RFC del contribuyente"
          },
          "uuid": {
            "type": "string",
            "description": "UUID del CFDI a descargar"
          }
        }
      },
      "CIECModel": {
        "type": "object",
        "required": ["rfc", "password"],
        "properties": {
          "rfc": {
            "type": "string",
            "description": "RFC del contribuyente"
          },
          "password": {
            "type": "string",
            "description": "Contraseña del CIEC"
          }
        }
      },
      "Error": {
        "type": "object",
        "required": ["error", "message"],
        "properties": {
          "error": {
            "type": "integer",
            "format": "int32"
          },
          "message": {
            "type": "string"
          }
        }
      }
    }
  }
}
